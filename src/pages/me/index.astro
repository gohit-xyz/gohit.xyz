---
import Layout from '@/layouts/Layout.astro'
import meImage from '@/assets/images/profile/me.jpg'
import NextPageBtn from '@/components/ui/buttons/NextPageBtn.astro'
import BackButtonTwo from '@/components/ui/buttons/BackButtonTwo.astro'
import { TwitterIcon, GitHubTwoIcon, ArrowBackIcon } from '@/components/icons/icons'
import { ArrowDownIcon } from '@/components/icons/global/arrow-down'
import { getCollection } from 'astro:content'

// Get latest article
const articles = await getCollection('articles', ({ data }) => data.draft !== true)
const latestArticle = articles.sort(
  (a, b) => new Date(b.data.publishDate).getTime() - new Date(a.data.publishDate).getTime()
)[0]

// Format date helper
const formatDate = (date: Date | string) => {
  return new Date(date).toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'long',
    day: 'numeric',
  })
}

// Render the article content
const { Content } = await latestArticle.render()
---

<Layout>
  <div class="custom-cursor flex min-h-screen w-full items-center justify-center">
    <main class="relative mx-auto w-full max-w-4xl px-6 py-8 sm:px-6">
      <!-- Back & Date -->
      <nav class="mb-8 flex items-center gap-2 text-sm text-gray-400">
        <BackButtonTwo href="/" text="Back" />
        <span class="opacity-40">/</span>
        <time
          datetime={latestArticle.data.publishDate instanceof Date
            ? latestArticle.data.publishDate.toISOString()
            : latestArticle.data.publishDate}
          class="text-gray-500"
        >
          {formatDate(latestArticle.data.publishDate)}
        </time>
      </nav>

      <!-- Main title -->
      <h1 class="mb-12 text-4xl font-bold md:text-5xl">
        Gohit X: FrontEnd
        <span class="block sm:inline">
          (<span class="opacity-60">
            <span class="text-[#f84f00]">web</span>,{' '}
            <span>mobile</span>, <span>üõ†Ô∏è</span>
          </span>)
        </span>
      </h1>

      <!-- Author Profile -->
      <div class="mb-4">
        <div class="flex items-center gap-4">
          <div
            class="relative h-16 w-16 overflow-hidden rounded-full border-4 border-black shadow-xl ring-2 ring-gray-800"
          >
            <img
              src={meImage.src}
              alt="Gohit Bastian Profile"
              class="h-full w-full object-cover"
              loading="eager"
            />
          </div>
          <div>
            <div class="text-xl font-semibold">Gohit Bastian</div>
            <div class="flex items-center gap-2 text-sm text-gray-400">
              <span>@gohitx</span>
              <div class="flex gap-1.5">
                <a
                  href="https://twitter.com/gohitx"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="transition-colors hover:text-[#f84f00]"
                >
                  <TwitterIcon className="h-4 w-4" />
                </a>
                <a
                  href="https://github.com/gohitx"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="transition-colors hover:text-[#f84f00]"
                >
                  <GitHubTwoIcon className="h-4 w-4" />
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="space-y-8 leading-relaxed opacity-80">
        <!-- Introduction -->
        <p>
          Hello üëã, my name is{' '}
          <span class="font-semibold opacity-100">Gohit</span>,{' '}
          <span class="italic">I'm from Peru üáµüá™</span> and I'm a Frontend developer (Web & Mobile). I'm
          also a content creator focused on software and a bit of hardware. I also contribute to open
          source in different communities with extensions for VS Code, Linux, and more. My favorite tools
          right now are{' '}
          <span class="font-bold opacity-100">Next.js</span> for the web and <span
            class="font-bold opacity-100">Expo</span
          > for mobile applications (Learning Lynxjs).
        </p>

        <p>
          I'm the creator and maintainer of multiple extensions available on{' '}
          <span class="font-semibold opacity-100">VS Code</span> ‚Ä¢ Cursor ‚Ä¢ Windsurf ‚Ä¢ Trae.ai ‚Ä¢ Kiro
          & Firebase Studio, etc. If you want to learn more or install the extensions, you can find them{
            ' '
          }
          <a
            class="text-blue-400 hover:underline"
            href="https://marketplace.visualstudio.com/publishers/bastndev"
            target="_blank"
            rel="noopener noreferrer"
          >
            here
          </a>
          .
        </p>
      </div>

      <!-- TODO:  -->
      <div class="relative mx-auto my-5 mt-24 max-w-4xl">
        <div class="h-px w-full bg-linear-to-r from-transparent via-gray-800 to-transparent"></div>
        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2">
          <span
            class="rounded-lg bg-[#0e0e0e] px-4 py-2 text-sm font-semibold text-white ring-1 ring-gray-800"
          >
            Latest Blog
          </span>
        </div>
      </div>
      <!-- TODO:  -->

      <!-- MARK: Latest Blog Post Preview -->
      {
        latestArticle && (
          <div class="relative mx-auto w-full">
            {/* Article Content Preview (Limited Height) */}
            <div class="relative overflow-hidden" style="max-height: 54rem;">
              <div class="space-y-8 leading-relaxed opacity-80">
                <div class="prose prose-invert prose-lg mx-auto max-w-none">
                  <Content />
                </div>
              </div>

              {/* Fade Gradient Overlay */}
              <div class="pointer-events-none absolute right-0 bottom-0 left-0 h-48 bg-linear-to-t from-(--bg) via-(--bg)/80 to-transparent" />
            </div>

            {/* Read Full Article Button */}
            <div class="mt-8 flex justify-center">
              <a href={`/blog/${latestArticle.slug}`}>
                <button class="group flex h-12 w-12 cursor-pointer items-center justify-center rounded-full border-2 border-gray-800 bg-black">
                  <ArrowDownIcon className="h-5 w-5 transition-transform group-hover:translate-y-0.5 text-white" />
                </button>
              </a>
            </div>
          </div>
        )
      }

      <!-- Button Article -->
      <div class="flex justify-end pt-6">
        <NextPageBtn href="/blog" text="More Blog Posts" class="cursor-pointer" />
      </div>
    </main>
  </div>
</Layout>

<style is:global>
  * {
    scrollbar-width: none;
    scrollbar-color: transparent transparent;
  }
  .custom-cursor {
    cursor: url('/cursors/Pointer.ico'), default;
  }

  /* Prose Styling for Blog Content */
  .prose {
    max-width: 65ch;
    color: #e5e7eb;
  }

  .prose h1,
  .prose h2,
  .prose h3,
  .prose h4,
  .prose h5,
  .prose h6 {
    color: #f9fafb;
    font-weight: 700;
    margin-top: 2rem;
    margin-bottom: 1rem;
  }

  .prose h1 {
    font-size: 2.25rem;
  }
  .prose h2 {
    font-size: 1.875rem;
  }
  .prose h3 {
    font-size: 1.5rem;
  }

  .prose p {
    margin-bottom: 1.25rem;
    line-height: 1.75;
  }

  .prose a {
    color: #60a5fa;
    text-decoration: underline;
    transition: color 0.2s;
  }

  .prose a:hover {
    color: #93c5fd;
  }

  .prose code {
    background-color: #1f2937;
    padding: 0.2rem 0.4rem;
    border-radius: 0.25rem;
    font-size: 0.875em;
    color: #fbbf24;
  }

  .prose pre {
    background-color: #111827;
    padding: 1rem;
    border-radius: 0.5rem;
    overflow-x: auto;
    margin: 1.5rem 0;
    border: 1px solid #374151;
  }

  .prose pre code {
    background-color: transparent;
    padding: 0;
    color: #e5e7eb;
  }

  .prose ul,
  .prose ol {
    padding-left: 1.5rem;
    margin-bottom: 1.25rem;
  }

  .prose li {
    margin-bottom: 0.5rem;
  }

  .prose blockquote {
    border-left: 4px solid #60a5fa;
    padding-left: 1rem;
    margin: 1.5rem 0;
    font-style: italic;
    color: #9ca3af;
  }

  .prose strong {
    font-weight: 600;
    color: #f9fafb;
  }

  .prose hr {
    border-color: #374151;
    margin: 2rem 0;
  }

  @media (max-width: 640px) {
    .prose {
      font-size: 0.95rem;
    }
    .prose h1 {
      font-size: 1.875rem;
    }
    .prose h2 {
      font-size: 1.5rem;
    }
    .prose h3 {
      font-size: 1.25rem;
    }
  }
</style>
