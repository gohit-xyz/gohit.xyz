---
import Layout from '@/layouts/Layout.astro'
import ThemeToggle from '@/components/ThemeToggle'
import Footer from '@/sections/shared/Footer.astro'
import { getCollection } from 'astro:content'
import { HorizontalLine, VerticalLinesFade ,BackButtonOne, CircleButtonUp} from '@/components/ui/ui'
import BlogArticlesCard from '@/components/ui/grids/BlogArticlesCard.astro'

// Get Articles Collection & Sort
const articles = await getCollection('articles', ({ data }) => data.draft !== true)
const sortedArticles = articles.sort(
  (a, b) => new Date(b.data.publishDate).getTime() - new Date(a.data.publishDate).getTime()
)
---

<Layout>
  <div class="relative min-h-screen w-full">
    <VerticalLinesFade/>
    <main class="relative mx-auto max-w-4xl px-6 pt-8 pb-2 lg:px-8">
      <!-- Theme Toggle -->
      <ThemeToggle client:idle />

      <!-- ========== HEADER SECTION ========== -->
      <header class="mb-11">
        <BackButtonOne href="/" text="Home" />

        <div class="space-y-4">
          <h1 class="text-5xl font-bold tracking-tight lg:text-6xl">Blog X</h1>
          <p class="text-xl text-gray-600 dark:text-gray-400">
            Thoughts, insights, and learnings from our journey
          </p>
        </div>

        <HorizontalLine/>
      </header>

      <!-- ========== ARTICLES GRID ========== -->
      <BlogArticlesCard articles={sortedArticles} />

      <!-- ========== EMPTY STATE ========== -->
      {
        sortedArticles.length === 0 && (
          <div class="flex min-h-[400px] items-center justify-center">
            <div class="text-center">
              <p class="text-xl text-gray-500 dark:text-gray-500">No articles published yet.</p>
              <p class="mt-2 text-sm text-gray-400 dark:text-gray-600">
                Check back soon for new content!
              </p>
            </div>
          </div>
        )
      }
      <!-- LINE HORIZONTAL -->
      <HorizontalLine/>
      <!-- Footer Component -->
      <Footer />
    </main>

    <!-- Scroll to Top Button -->
    <div class="scroll-to-top-wrapper">
      <CircleButtonUp />
    </div>
  </div>
</Layout>

<!-- --- --- -- --- -- -- MARK:Styles -->
<style>
  .scroll-to-top-wrapper {
    position: fixed;
    bottom: 2rem;
    right: 1.5rem;
    z-index: 50;
  }

  /* Desktop: Align with article container */
  @media (min-width: 1024px) {
    .scroll-to-top-wrapper {
      left: 50%;
      right: auto;
      transform: translateX(calc(512px - 4rem));
    }
  }

  :global(.theme-toggle) {
    position: absolute;
    top: 1.5rem;
    right: 1.5rem;
    background-color: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(10px);
    border-radius: 50%;
    padding: 10px;
    cursor: pointer;
    border: 1px solid rgba(75, 85, 99, 0.3);
    transition: all 0.3s ease;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
    z-index: 50;
  }

  :global(.theme-toggle:hover) {
    background-color: rgba(0, 0, 0, 0.8);
    border-color: rgba(156, 163, 175, 0.5);
    transform: rotate(15deg) scale(1.05);
  }

  :global(.theme-toggle svg) {
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
    transition: transform 0.3s ease;
    width: 20px;
    height: 20px;
  }

  @media (max-width: 768px) {
    :global(.theme-toggle) {
      top: 1rem;
      right: 1rem;
      padding: 8px;
    }

    :global(.theme-toggle svg) {
      width: 18px;
      height: 18px;
    }
  }

  /* ========== GLOBAL STYLES ========== */

  html {
    scroll-behavior: smooth;
  }
</style>